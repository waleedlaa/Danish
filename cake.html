<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Replace "99" with "66" — Cake Editor</title>

  <!-- Optional: Google font that looks like cake icing -->
  <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">

  <style>
    body {
      font-family: system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
      margin: 20px;
      display: flex;
      gap: 20px;
      align-items: flex-start;
    }
    .left {
      max-width: 720px;
      border: 1px solid #ddd;
      padding: 12px;
      border-radius: 10px;
      box-shadow: 0 6px 18px rgba(0,0,0,0.08);
      background: #fff;
    }
    canvas {
      display: block;
      max-width: 100%;
      border-radius: 8px;
      background: #f6f6f6;
    }
    .controls {
      min-width: 300px;
      max-width: 360px;
      padding: 12px;
      border: 1px solid #eee;
      border-radius: 10px;
      background: #fff;
      box-shadow: 0 6px 18px rgba(0,0,0,0.04);
    }
    .controls h3 { margin: 0 0 8px 0; }
    .row { display:flex; gap:8px; align-items:center; margin:8px 0; }
    label { font-size: 13px; color: #333; width: 110px; }
    input[type="range"] { flex:1; }
    input[type="color"] { width:44px; height:32px; padding:0; border:0; background:transparent; }
    button { padding:8px 12px; border-radius:6px; border:1px solid #ccc; background:#fafafa; cursor:pointer; }
    .small { font-size: 13px; color:#666; margin-top:6px; }
    footer { margin-top:10px; font-size:12px; color:#666; }
  </style>
</head>
<body>

  <div class="left">
    <div style="display:flex;gap:10px;align-items:center;justify-content:space-between;">
      <div>
        <strong>Cake editor — replace "99" with "66"</strong>
        <div class="small">Tip: use the controls to match placement, size and color to your cake.</div>
      </div>
      <div>
        <input id="fileInput" type="file" accept="image/*" />
        <button id="downloadBtn">Download PNG</button>
      </div>
    </div>

    <hr style="margin:12px 0;">

    <canvas id="canvas"></canvas>
    <footer>Default: will try to load <code>cake-99.jpg</code> from same folder. Or choose your own image above.</footer>
  </div>

  <div class="controls">
    <h3>Text settings</h3>

    <div class="row">
      <label>Text</label>
      <input id="textInput" type="text" value="66" style="flex:1" />
    </div>

    <div class="row">
      <label>Font</label>
      <select id="fontSelect" style="flex:1">
        <option value="Great Vibes, cursive">Great Vibes (script)</option>
        <option value="48px serif">Serif</option>
        <option value="48px sans-serif">Sans</option>
      </select>
    </div>

    <div class="row">
      <label>Size</label>
      <input id="size" type="range" min="24" max="400" value="180" />
      <div id="sizeVal">180</div>
    </div>

    <div class="row">
      <label>Rotation</label>
      <input id="rot" type="range" min="-90" max="90" value="0" />
      <div id="rotVal">0°</div>
    </div>

    <div class="row">
      <label>Position X</label>
      <input id="posX" type="range" min="0" max="100" value="50" />
      <div id="posXVal">50%</div>
    </div>

    <div class="row">
      <label>Position Y</label>
      <input id="posY" type="range" min="0" max="100" value="50" />
      <div id="posYVal">50%</div>
    </div>

    <div class="row">
      <label>Fill color</label>
      <input id="fillColor" type="color" value="#ffffff" />
      <div class="small" style="margin-left:8px">Usually white/cream</div>
    </div>

    <div class="row">
      <label>Stroke color</label>
      <input id="strokeColor" type="color" value="#e0cfc0" />
      <div class="small" style="margin-left:8px">Icing edge</div>
    </div>

    <div class="row">
      <label>Stroke width</label>
      <input id="strokeWidth" type="range" min="0" max="30" value="6" />
      <div id="strokeWidthVal">6</div>
    </div>

    <hr>

    <h3>Cover (hide original 99)</h3>
    <div class="row">
      <label>Cover shape</label>
      <select id="coverShape" style="flex:1">
        <option value="none">None</option>
        <option value="circle">Circle</option>
        <option value="ellipse">Ellipse</option>
        <option value="rect">Rectangle</option>
      </select>
    </div>

    <div class="row">
      <label>Cover color</label>
      <input id="coverColor" type="color" value="#d9bfae" />
      <div class="small" style="margin-left:8px">Pick a cake color to blend over old digits</div>
    </div>

    <div class="row">
      <label>Cover size</label>
      <input id="coverSize" type="range" min="10" max="300" value="80" />
      <div id="coverSizeVal">80</div>
    </div>

    <div style="margin-top:12px; display:flex; gap:8px;">
      <button id="redraw">Redraw</button>
      <button id="reset">Reset</button>
    </div>

    <div style="margin-top:12px; font-size:13px; color:#444;">
      <strong>How to use:</strong>
      <ul style="margin:6px 0 0 18px; padding:0;">
        <li>Open the file in browser. If `cake-99.jpg` exists it will load automatically.</li>
        <li>Use sliders to position/size/rotate the "66" to match the writing on your cake.</li>
        <li>Use Cover to paint over the original "99" (pick a cake color close to your cake).</li>
        <li>Click "Download PNG" to save the edited cake image with "66".</li>
      </ul>
    </div>
  </div>

<script>
  const canvas = document.getElementById('canvas');
  const ctx = canvas.getContext('2d');

  // UI elements
  const fileInput = document.getElementById('fileInput');
  const downloadBtn = document.getElementById('downloadBtn');
  const textInput = document.getElementById('textInput');
  const fontSelect = document.getElementById('fontSelect');
  const sizeRange = document.getElementById('size');
  const sizeVal = document.getElementById('sizeVal');
  const rotRange = document.getElementById('rot');
  const rotVal = document.getElementById('rotVal');
  const posX = document.getElementById('posX');
  const posXVal = document.getElementById('posXVal');
  const posY = document.getElementById('posY');
  const posYVal = document.getElementById('posYVal');
  const fillColor = document.getElementById('fillColor');
  const strokeColor = document.getElementById('strokeColor');
  const strokeWidth = document.getElementById('strokeWidth');
  const strokeWidthVal = document.getElementById('strokeWidthVal');

  const coverShape = document.getElementById('coverShape');
  const coverColor = document.getElementById('coverColor');
  const coverSize = document.getElementById('coverSize');
  const coverSizeVal = document.getElementById('coverSizeVal');

  const redrawBtn = document.getElementById('redraw');
  const resetBtn = document.getElementById('reset');

  let img = new Image();
  let defaultLoaded = false;

  function setDefaults() {
    sizeVal.textContent = sizeRange.value;
    rotVal.textContent = rotRange.value + '°';
    posXVal.textContent = posX.value + '%';
    posYVal.textContent = posY.value + '%';
    strokeWidthVal.textContent = strokeWidth.value;
    coverSizeVal.textContent = coverSize.value;
  }

  setDefaults();

  // Try to load default file cake-99.jpg (user may have uploaded that earlier)
  img.onload = () => {
    defaultLoaded = true;
    resizeCanvasToImage();
    drawAll();
  };

  img.onerror = () => {
    if (!defaultLoaded) {
      // blank canvas placeholder
      canvas.width = 640;
      canvas.height = 360;
      ctx.fillStyle = '#f2f2f2';
      ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = '#999';
      ctx.font = '16px sans-serif';
      ctx.fillText('No image loaded — choose an image or put cake-99.jpg next to this file.', 12, 30);
    }
  };

  // attempt to load cake-99.jpg from same folder
  img.src = 'cake-99.jpg';

  function resizeCanvasToImage() {
    const maxW = 1200; // keep reasonable size
    const scale = img.width > maxW ? (maxW / img.width) : 1;
    canvas.width = Math.round(img.width * scale);
    canvas.height = Math.round(img.height * scale);
  }

  function clearCanvas() {
    ctx.clearRect(0,0,canvas.width,canvas.height);
  }

  function drawCover(x, y) {
    const shape = coverShape.value;
    const size = Number(coverSize.value);
    ctx.save();
    ctx.fillStyle = coverColor.value;
    if (shape === 'circle') {
      ctx.beginPath();
      ctx.arc(x, y, size, 0, Math.PI*2);
      ctx.fill();
    } else if (shape === 'ellipse') {
      ctx.beginPath();
      ctx.ellipse(x, y, size*1.3, size, 0, 0, Math.PI*2);
      ctx.fill();
    } else if (shape === 'rect') {
      ctx.fillRect(x - size, y - Math.round(size/1.2), size*2, size*1.4);
    }
    ctx.restore();
  }

  function drawText(x, y) {
    const text = textInput.value || '66';
    const fontSetting = fontSelect.value;
    const size = Number(sizeRange.value);
    const rotation = Number(rotRange.value) * Math.PI / 180;
    const fnt = `${size}px ${fontSetting}`;
    ctx.save();

    ctx.translate(x, y);
    ctx.rotate(rotation);

    // shadow for depth (soft)
    ctx.shadowColor = 'rgba(0,0,0,0.25)';
    ctx.shadowBlur = Math.max(6, size * 0.06);
    ctx.shadowOffsetX = size * 0.02;
    ctx.shadowOffsetY = size * 0.02;

    // stroke (the icing border)
    ctx.lineJoin = 'round';
    ctx.lineCap = 'round';
    ctx.miterLimit = 2;
    ctx.font = fnt;
    ctx.textAlign = 'center';
    ctx.textBaseline = 'middle';

    // thicker stroke behind to simulate piped icing edge
    ctx.lineWidth = Number(strokeWidth.value) + Math.round(size * 0.06);
    ctx.strokeStyle = strokeColor.value;
    ctx.strokeText(text, 0, 0);

    // main stroke
    ctx.lineWidth = Number(strokeWidth.value);
    ctx.strokeStyle = strokeColor.value;
    ctx.strokeText(text, 0, 0);

    // fill (icing)
    ctx.fillStyle = fillColor.value;
    ctx.fillText(text, 0, 0);

    ctx.restore();
  }

  function drawAll() {
    if (!img.complete || !img.naturalWidth) {
      // nothing to draw
      clearCanvas();
      ctx.fillStyle = '#f2f2f2';
      ctx.fillRect(0,0,canvas.width,canvas.height);
      ctx.fillStyle = '#777';
      ctx.font = '14px sans-serif';
      ctx.fillText('Load an image to start editing...', 12, 30);
      return;
    }
    // draw image scaled to canvas
    ctx.setTransform(1,0,0,1,0,0);
    ctx.clearRect(0,0,canvas.width,canvas.height);
    const scale = canvas.width / img.width;
    ctx.drawImage(img, 0, 0, img.width * scale, img.height * scale);

    // compute position in px from percentages
    const x = canvas.width * Number(posX.value) / 100;
    const y = canvas.height * Number(posY.value) / 100;

    // cover original numbers first (if requested)
    if (coverShape.value !== 'none') {
      drawCover(x, y);
    }

    // draw "66"
    drawText(x, y);
  }

  // controls events
  [sizeRange, rotRange, posX, posY, strokeWidth, coverSize].forEach(el => {
    el.addEventListener('input', () => {
      setDefaults();
      drawAll();
    });
  });

  [textInput, fontSelect, fillColor, strokeColor, coverColor, coverShape].forEach(el => {
    el.addEventListener('change', drawAll);
  });

  fileInput.addEventListener('change', (e) => {
    const file = e.target.files && e.target.files[0];
    if (!file) return;
    const url = URL.createObjectURL(file);
    img = new Image();
    img.onload = () => {
      resizeCanvasToImage();
      drawAll();
      URL.revokeObjectURL(url);
    };
    img.src = url;
  });

  redrawBtn.addEventListener('click', drawAll);

  resetBtn.addEventListener('click', () => {
    // reasonable defaults
    textInput.value = '66';
    fontSelect.value = 'Great Vibes, cursive';
    sizeRange.value = 180;
    rotRange.value = 0;
    posX.value = 50;
    posY.value = 50;
    fillColor.value = '#ffffff';
    strokeColor.value = '#e0cfc0';
    strokeWidth.value = 6;
    coverShape.value = 'circle';
    coverColor.value = '#d9bfae';
    coverSize.value = 80;
    setDefaults();
    drawAll();
  });

  downloadBtn.addEventListener('click', () => {
    const url = canvas.toDataURL('image/png');
    const a = document.createElement('a');
    a.href = url;
    a.download = 'cake-66.png';
    a.click();
  });

  // keep UI labels updated
  sizeRange.addEventListener('input', ()=> sizeVal.textContent = sizeRange.value);
  rotRange.addEventListener('input', ()=> rotVal.textContent = rotRange.value + '°');
  posX.addEventListener('input', ()=> posXVal.textContent = posX.value + '%');
  posY.addEventListener('input', ()=> posYVal.textContent = posY.value + '%');
  strokeWidth.addEventListener('input', ()=> strokeWidthVal.textContent = strokeWidth.value);
  coverSize.addEventListener('input', ()=> coverSizeVal.textContent = coverSize.value);

  // initial draw attempt (in case default loaded earlier)
  setTimeout(drawAll, 300);
</script>
</body>
</html>
